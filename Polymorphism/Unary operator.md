# تحميل العوامل الزائد (Operator Overloading) في C++

في لغة C++، **تحميل العوامل الزائد** (Operator Overloading) يشير إلى القدرة على إعادة تعريف سلوك العوامل مثل العوامل الحسابية، المنطقية، والعلائقية للأنواع المعرفة من قبل المستخدم. **العوامل الأحادية** (Unary Operators) هي تلك العوامل التي تعمل على معامل واحد فقط. تحميل العوامل الأحادية يسمح لك بتخصيص سلوكها عند تطبيقها على كائنات من فئاتك الخاصة.

## الغرض من تحميل العوامل الزائد:

### 1. توفير صياغة طبيعية (Provide Natural Syntax):
تحميل العوامل الزائد يسمح لك باستخدام العوامل مع الأنواع المعرفة من قبل المستخدم بطريقة تحاكي استخدامها مع الأنواع المدمجة. على سبيل المثال:
- يمكنك جمع كائنين من فئة باستخدام العامل `+`
- دمج النصوص باستخدام العامل `+`
- زيادة كائن باستخدام العامل `++`

### 2. تحسين قابلية القراءة (Enhance Readability):
من خلال تحميل العوامل، يمكنك جعل الكود الخاص بك أكثر سهولة وقابلية للقراءة، حيث يسمح لك بالتعبير عن العمليات بطريقة طبيعية وموجزة.

## أمثلة على العوامل الأحادية (Unary Operators):

| العامل | الوصف | المثال |
|--------|--------|---------|
| `++` | الزيادة (Increment) | `++obj` أو `obj++` |
| `--` | النقصان (Decrement) | `--obj` أو `obj--` |
| `-` | السالب (Negation) | `-obj` |
| `!` | النفي المنطقي (Logical NOT) | `!obj` |
| `~` | المكمل الثنائي (Bitwise NOT) | `~obj` |
| `*` | إزالة المرجعية (Dereference) | `*ptr` |
| `&` | العنوان (Address-of) | `&obj` |

## الفوائد الرئيسية:

✅ **الوضوح**: الكود يصبح أكثر وضوحاً وسهولة في الفهم  
✅ **الاختصار**: تقليل كمية الكود المطلوب لإجراء العمليات  
✅ **التناسق**: استخدام نفس الصياغة للأنواع المدمجة والمخصصة  
✅ **المرونة**: القدرة على تخصيص سلوك العوامل حسب احتياجات الفئة  

## ملاحظة مهمة:

عند تحميل العوامل، يجب الحفاظ على المعنى الطبيعي والمتوقع للعامل. على سبيل المثال، العامل `+` يجب أن يُستخدم لعمليات الجمع أو الدمج، وليس لعمليات غير متعلقة مثل الحذف أو المقارنة.




# مثال 1: تحميل زائد للعامل الأحادي ++ في C++

هذا الكود بلغة C++ يوضح كيفية عمل التحميل الزائد (Overloading) للعامل الأحادي `++` لفئة تُسمى `Unary`. دعنا نشرح الكود بالتفصيل:

## الكود:

```cpp
#include <iostream>
using namespace std;

class Unary {
    int x, y;
public:
    Unary(int i = 0, int j = 0) {
        x = i;  
        y = j;
    }
    
    void show() {
        cout << x << " " << y << endl;
    }
    
    // التحميل الزائد للعامل الأحادي ++ كدالة عضو
    void operator++() {
        x++;
        y++;
    }
};

int main() {
    Unary v(10, 20);
    v++; // زيادة قيم الكائن 'v' باستخدام العامل ++ المحمّل
    v.show(); // عرض القيم المحدثة لـ 'x' و 'y'
    return 0;
}
```



الشرح:
الفئة Unary تحتوي على متغيرين خاصين x و y، ومُنشئ (Constructor) لتهيئتهما. بالإضافة إلى ذلك، لديها دالة عضو show() لعرض قيم x و y.

داخل تعريف الفئة، يتم عمل تحميل زائد للعامل الأحادي ++ باستخدام دالة العضو operator++(). هذه الدالة تزيد قيم x و y.

في دالة main()، يتم إنشاء كائن v من الفئة Unary بقيم ابتدائية 10 لـ x و 20 لـ y.

يتم تطبيق العامل ++ على الكائن v باستخدام v++. بما أنه عامل أحادي، فهو لا يحتاج إلى أي معامل (Operand).

الدالة المحملة operator++() تزيد قيم x و y بمقدار واحد.

بعد عملية الزيادة، يتم استدعاء دالة show() لعرض القيم المحدثة لـ x و y.
```cpp
الناتج:
11 21
```
السبب: قيم x و y تمت زيادتها بمقدار 1 بعد تطبيق العامل ++ على الكائن v. وبالتالي، القيم المحدثة المعروضة هي 11 لـ x و 21 لـ y.


---

# مثال 2: الفرق بين العامل ++ البادئ (Prefix) واللاحق (Postfix)

هذا الكود بلغة C++ يوضح كيفية عمل التحميل الزائد للعامل الأحادي `++` لفئة تُسمى `Unary`، مع التمييز بين عامل الزيادة البادئ والعامل اللاحق الذي يأخذ معامل صحيح وهمي إضافي. دعنا نشرح الكود بالتفصيل:

## الكود:

```cpp
#include <iostream>
using namespace std;

class Unary {
    int x, y;
public:
    Unary(int i = 0, int j = 0) {
        x = i;  
        y = j;
    }
    
    void show() { 
        cout << x << " " << y << endl; 
    }
    
    // التحميل الزائد لعامل الزيادة البادئ (Prefix ++)
    Unary operator++() {
        x++;
        y++;
        return *this;
    }
    
    // التحميل الزائد لعامل الزيادة اللاحق (Postfix ++)
    Unary operator++(int) {
        Unary t;
        t = *this;
        x++;
        y++;
        return t;
    }
};

int main() {
    Unary v(10, 20), k;
    v++;
    k = v++;
    k.show();
    v.show();
    return 0;
}
```

الشرح:
الفئة Unary تحتوي على متغيرين خاصين x و y، ومُنشئ (Constructor) لتهيئتهما. بالإضافة إلى ذلك، لديها دالة عضو show() لعرض قيم x و y.

داخل تعريف الفئة، يتم عمل تحميل زائد للعامل ++ مرتين:

دالة operator++(): تحمل العامل البادئ ++ (Prefix). تزيد قيم x و y ثم تُرجع الكائن المُحدث.

دالة operator++(int): تحمل العامل اللاحق ++ (Postfix) مع معامل صحيح وهمي إضافي. تُنشئ كائن مؤقت t وتُسند إليه قيم الكائن الحالي. ثم تزيد قيم x و y للكائن الحالي وتُرجع الكائن المؤقت t.

في دالة main()، يتم إنشاء كائنين v و k من الفئة Unary، حيث يتم تهيئة v بقيم 10 لـ x و 20 لـ y.

v++ يتم تطبيقه لزيادة v باستخدام عامل الزيادة اللاحق. هذا سيزيد قيم x و y الخاصة بـ v ويُرجع كائن مؤقت بالقيم الأصلية.

k = v++ سيقوم أولاً بإسناد الكائن المؤقت (بالقيم الأصلية) إلى k ثم يزيد v باستخدام عامل الزيادة اللاحق.

يتم استدعاء دالة show() لعرض قيم k و v بعد عمليات الزيادة.
```cpp
الناتج:
11 21
12 22
```
تفسير الناتج:
السطر الأول (11 21): هذه قيم k التي تساوي القيم القديمة لـ v قبل الزيادة الثانية (كانت v تساوي 11 و 21 بعد العملية الأولى v++).

السطر الثاني (12 22): هذه قيم v النهائية بعد عمليتي الزيادة.

الفرق بين Prefix و Postfix:
Prefix (++v): يزيد القيمة أولاً ثم يُرجع الكائن المُحدث.
Postfix (v++): يحفظ القيمة القديمة، يزيد القيمة، ثم يُرجع القيمة القديمة.
 ---
 # مثال 3: تحميل زائد للعامل الأحادي السالب (-)

هذا الكود بلغة C++ يوضح كيفية عمل التحميل الزائد للعامل الأحادي `-` بالإضافة إلى عاملي الزيادة البادئ واللاحق `++` لفئة تُسمى `Unary`. دعنا نشرح الكود بالتفصيل:

## الكود:

```cpp
#include <iostream>
using namespace std;

class Unary {
    int x, y;
public:
    Unary(int i = 0, int j = 0) {
        x = i;  
        y = j;
    }
    
    void show() {
        cout << x << " " << y << endl;
    }
    
    // التحميل الزائد لعامل الزيادة البادئ (Prefix ++)
    Unary operator++() {
        x++;
        y++;
        return *this;
    }
    
    // التحميل الزائد لعامل الزيادة اللاحق (Postfix ++)
    Unary operator++(int) {
        Unary t;
        t = *this;
        x++;
        y++;
        return t;
    }
    
    // التحميل الزائد للعامل الأحادي السالب (-)
    Unary operator-() {
        x = -x;
        y = -y;
        return *this;
    }
};

int main() {
    Unary k(1, 2); // إنشاء كائن من الفئة Unary بقيم ابتدائية 1 و 2
    -k; // تطبيق العامل الأحادي - على الكائن k
    k.show(); // عرض القيم المحدثة لـ k
    return 0;
}
```
الشرح:
دالة operator-(): تحمل العامل الأحادي - (السالب). تقوم بعكس إشارة قيم x و y عن طريق ضربهما في -1 وتُرجع الكائن المُحدث.

في دالة main()، يتم إنشاء كائن k من الفئة Unary بقيم ابتدائية 1 لـ x و 2 لـ y.

يتم تطبيق العامل الأحادي - على الكائن k باستخدام -k. هذا سيعكس إشارة قيم x و y الخاصة بـ k.

أخيراً، يتم استدعاء دالة show() لعرض القيم المحدثة لـ x و y.
```cpp
الناتج:
-1 -2
```
تفسير الناتج:
هذا يوضح أن قيم x و y للكائن k تم عكس إشارتها عن طريق تطبيق العامل الأحادي -. لذلك، x أصبح -1 و y أصبح -2.

ملاحظة مهمة:
العامل الأحادي - يقوم بتعديل الكائن نفسه (يغير قيم x و y داخل الكائن الأصلي)، وليس مجرد إرجاع نسخة معكوسة. إذا أردت الحفاظ على القيم الأصلية، يمكن تعديل الدالة لإنشاء كائن جديد وإرجاعه بدلاً من تعديل الكائن الحالي.
---
# مثال 4: تحميل زائد لعامل النفي المنطقي (!)

هذا الكود بلغة C++ يوضح كيفية عمل التحميل الزائد لعامل النفي المنطقي `!` بالإضافة إلى العوامل الأخرى لفئة تُسمى `Unary`. دعنا نشرح الكود بالتفصيل:

## الكود:

```cpp
#include <iostream>
using namespace std;

class Unary {
    int x, y;
public:
    Unary(int i = 0, int j = 0) {
        x = i;  
        y = j;
    }
    
    void show() { 
        cout << x << " " << y << endl; 
    }
    
    // التحميل الزائد لعامل الزيادة البادئ (Prefix ++)
    Unary operator++() {
        x++;
        y++;
        return *this;
    }
    
    // التحميل الزائد لعامل الزيادة اللاحق (Postfix ++)
    Unary operator++(int) {
        Unary t;
        t = *this;
        x++;
        y++;
        return t;
    }
    
    // التحميل الزائد للعامل الأحادي السالب (-)
    Unary operator-() {
        x = -x;
        y = -y;
        return *this;
    }
    
    // التحميل الزائد لعامل النفي المنطقي (!)
    bool operator!() {
        return (x == 0 && y == 0);
    }
};

int main() {
    Unary x(1, 1);
    if (!x)
        cout << "true";
    else
        cout << "false";
    return 0;
}
```
الشرح:
دالة operator!(): تحمل عامل النفي المنطقي !. تُرجع true إذا كان كل من x و y يساوي 0، مما يشير إلى أن الكائن "منطقياً خاطئ" (Logically False). خلاف ذلك، تُرجع false.

في دالة main()، يتم إنشاء كائن x من الفئة Unary بقيم ابتدائية 1 لـ x و 1 لـ y.

يتم تطبيق عامل النفي المنطقي ! على الكائن x باستخدام !x. إذا كان x منطقياً خاطئ (أي كل من x و y يساوي 0)، يطبع "true". خلاف ذلك، يطبع "false".
```cpp
الناتج:
false
```
تفسير الناتج:
الكائن x تم تهيئته بقيم (1, 1)، وهما ليسا صفرين.
عند تطبيق !x، تفحص الدالة operator!() إذا كان x == 0 && y == 0.
بما أن الشرط غير محقق (القيم هي 1 و 1)، تُرجع الدالة false.
لذلك يتم تنفيذ الجزء else ويُطبع "false".
ملاحظة مهمة:
عامل النفي المنطقي ! يُستخدم لفحص ما إذا كان الكائن في حالة "فارغة" أو "صفرية". في هذا المثال، الكائن يُعتبر منطقياً خاطئ فقط عندما يكون كلا المتغيرين x و y يساويان صفر.
---
# مثال 5: تحميل زائد لعامل الإسناد المركب (+=)

هذا الكود بلغة C++ يوضح كيفية عمل التحميل الزائد لعامل الإسناد المركب `+=` بالإضافة إلى العوامل الأخرى لفئة تُسمى `Unary`. دعنا نشرح الكود بالتفصيل:

## الكود:

```cpp
#include <iostream>
using namespace std;

class Unary {
    int x, y;
public:
    Unary(int i = 0, int j = 0) {
        x = i;  
        y = j;
    }
    
    void show() { 
        cout << x << " " << y << endl; 
    }
    
    // التحميل الزائد لعامل الزيادة البادئ (Prefix ++)
    Unary operator++() {
        x++;
        y++;
        return *this;
    }
    
    // التحميل الزائد لعامل الزيادة اللاحق (Postfix ++)
    Unary operator++(int) {
        Unary t;
        t = *this;
        x++;
        y++;
        return t;
    }
    
    // التحميل الزائد للعامل الأحادي السالب (-)
    Unary operator-() {
        x = -x;
        y = -y;
        return *this;
    }
    
    // التحميل الزائد لعامل النفي المنطقي (!)
    bool operator!() {
        return (x == 0 && y == 0);
    }
    
    // التحميل الزائد لعامل الإسناد المركب (+=)
    Unary operator+=(Unary b2) {
        x += b2.x;
        y += b2.y;
        return *this;
    }
};

int main() {
    Unary b(1, 2), b2(3, 3);
    b += b2;
    b.show();
    
    return 0;
}
```
الشرح:
دالة operator+=(): تحمل عامل الإسناد المركب +=. تضيف المتغيرات الأعضاء المقابلة للكائن الحالي (this) مع المتغيرات الأعضاء للكائن الممرر (b2) وتُرجع الكائن المُحدث.

في دالة main()، يتم إنشاء كائنين:

b بقيم ابتدائية (1, 2)
b2 بقيم ابتدائية (3, 3)
يتم تطبيق عامل الإسناد المركب += باستخدام b += b2، مما يعني:

b.x = b.x + b2.x → 1 + 3 = 4
b.y = b.y + b2.y → 2 + 3 = 5
يتم استدعاء دالة show() لعرض القيم المحدثة للكائن b.
```cpp
الناتج:
4 5
```
تفسير الناتج:
الكائن b كان يحتوي على القيم (1, 2)
الكائن b2 يحتوي على القيم (3, 3)
بعد تطبيق b += b2:
x أصبح: 1 + 3 = 4
y أصبح: 2 + 3 = 5
لذلك يُطبع: 4 5
ملاحظة مهمة:
عامل الإسناد المركب += يقوم بتعديل الكائن الأيسر (في هذه الحالة b) مباشرةً ويُرجع إشارة إليه، مما يسمح بالتسلسل في العمليات مثل a += b += c.


